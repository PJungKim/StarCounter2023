# 센서 값 받아오기

- 계수기 내 IR 센서의 값을 받아오는 방법을 정리한 문서입니다.

## 1. 센서 번호 및 위치

- 위치[^3번과7번]

  |위치|Master|Slave|
  |--|--|--|
  |위|0|4|
  |중간|1|5|
  |아래|2|6|

- 센서 값 레지스터

  |레지스터|설명|읽기/쓰기|
  |--|--|--|
  |(0) `raw`|ADC에서 입력받은 센서 값|읽기|
  |(1) `BlackMin`|Calibration의 BlackMin값, 유효한 센서의 최솟값|읽기/쓰기|
  |(2) `WhiteMin`|Calibration의 WhiteMin값, 유효한 센서의 최댓값|읽기/쓰기|
  |(3) `value`|Normalized된 센서 값|읽기|

  - (3)번 레지스터는 (1)번과 (2)번의 데이터를 바탕으로 값을 0~255로 매핑해서 읽은 값을 저장합니다. 당연히 Calibraion값 범위를 넘어서면 끝값이 저장됩니다.
  - (3)번 레지스터를 사용하기 전에 Calibraition 과정을 거쳐야 합니다.
  - 따라서 이번 시간에는 Sensor값 중에서 Raw값만 다루고, 나머지 값은 계수기 코딩 파트에서 자세히 다루도록 하겠습니다.
 
## 2. 센서 값 함수

- 값을 읽어오는 함수

  |함수명|매개변수|설명|출력|
  |--|--|--|--|
  |`sensor[n].GetValue()`|`n` 센서 번호(0~7)|센서의 ADC 값을 받아옵니다.|센서의 ADC 값(0~4095)|
  |`sensor[n].GetBlackMin()`|`n` 센서 번호(0~7)|칼리브레이션의 BlackMin 레지스터 값을 받습니다.|BlackMin값(0~4095)|
  |`sensor[n].GetWhiteMin()`|`n` 센서 번호(0~7)|칼리브레이션의 WhiteMin 레지스터 값을 받습니다.|WhiteMin값(0~4095)|
  |`sensor[n].GetValue()`|`n` 센서 번호(0~7)|노멀라이즈된 센서 값을 받습니다.|유효 센서값(0~255)|

- 값을 쓰는 함수
  |함수명|매개변수|설명|출력|
  |--|--|--|--|
  |`sensor[n].SetBlackMin(value)`|`n` 센서 번호(0~7)<br>`value` BlackMin값|BlackMin값을 레지스터에 저장합니다.|void|
  |`sensor[n].SetWhiteMin(value)`|`n` 센서 번호(0~7)<br>`value` WhiteMin값|WhiteMin값을 레지스터에 저장합니다.|void|

## 3. (예제) 센서 읽기

- 버튼을 눌러 센서를 선택합니다(0~7).
- 센서의 값을 0~9로 출력합니다.
- 센서 값은 0~4095로 출력되므로 450으로 나눈 값을 출력합시다.
  - 예: 2번 센서 값이 5일때: 25 출력

  ```
  main(){
  }
  ```

[^3번과7번]: 사용하지 않는 센서
